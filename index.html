
<html>

<script src="https://creative-otter-tmmhku-dev-ed.trailblaze.my.site.com/lightning/lightning.out.js"></script>
<div data-lightning-out="true"></div>

<script>
    
    const clientId = '3MVG9HB6vm3GZZR9sIPMXbCsv33sKF.5BA6v2f5HkTAayVxntAHz5xOiWaIl.aZPR5hEFQ0Uq9qLxtCPrsW4U';
    const redirectUri = 'https://creative-otter-tmmhku-dev-ed.trailblaze.my.site.com';
    const authorizationEndpoint = 'https://login.salesforce.com/services/oauth2/authorize';
    const scope = '';
    const responseType = 'code';
    const authorizationUrl = `${authorizationEndpoint}?response_type=${responseType}&client_id=${encodeURIComponent(clientId)}&redirect_uri=${encodeURIComponent(redirectUri)}&scope=${encodeURIComponent(scope)}`;
    window.location.href = authorizationUrl;
    
    const appName= 'c:HelloWorldDependency';
    const componentName = 'c:helloWorld';
    const lightningEndpoint = 'https://creative-otter-tmmhku-dev-ed.trailblaze.my.site.com';
    const targetElement = document.querySelector("[data-lightning-out]");
    const componentAttributes = {};
  
    const tokenEndpoint = 'https://login.salesforce.com/services/oauth2/token';
    const grantType = 'authorization_code';
    const code = 'AUTHORIZATION_CODE'; // The code received after successful authorization

    const requestOptions = {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      body: `grant_type=${grantType}&client_id=${encodeURIComponent(clientId)}&redirect_uri=${encodeURIComponent(redirectUri)}&code=${encodeURIComponent(code)}`
    };
    var token = "";
    fetch(tokenEndpoint, requestOptions)
      .then(response => response.json())
      .then(data => {
        // Handle the response data
        token = data.access_token;
        console.log('OAuth token:', data.access_token);
      })
      .catch(error => {
        // Handle any errors
        console.error('Error:', error);
      });
    
    let renderLightningOutComponent = (oauthResult) => {
    const token = oauthResult.accessToken;
    const lightningendpointuri = "https://creative-otter-tmmhku-dev-ed.trailblaze.lightning.force.com";
    $Lightning.use(appName, () => {
        $Lightning.createComponent(componentName, {}, targetElement, (cmp) => { console.log('component created') });},
                   lightningendpointuri, token);
    }
  
</script>

</html>
